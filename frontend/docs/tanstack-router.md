# TanStack Router Learning Note

## Introduction to TanStack Router

TanStack Router is a type-safe, modern routing library for React applications, designed to provide flexible and efficient navigation. Part of the TanStack ecosystem, it offers features like file-based routing, automatic code splitting, and integration with development tools, making it suitable for building scalable single-page applications (SPAs). Its type-safe APIs reduce runtime errors, especially in TypeScript projects, and it supports both file-based and code-based route configurations.

## Installation

Install the core library, development tools, and Vite plugin:

```sh
npm install @tanstack/react-router @tanstack/react-router-devtools
npm install -D @tanstack/router-plugin
```

Alternative commands for other package managers (pnpm, yarn, bun, deno) are available in the [official documentation](https://tanstack.com/router/latest/docs/framework/react/quick-start).

## Configure the Vite Plugin

To enable file-based routing and automatic code splitting, configure the TanStack Router Vite plugin in `vite.config.ts`:

```tsx
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import { TanStackRouterVite } from "@tanstack/router-plugin/vite";

export default defineConfig({
  plugins: [
    TanStackRouterVite({ target: "react", autoCodeSplitting: true }),
    react(),
  ],
});
```

Ensure the TanStack Router plugin precedes the React plugin in the `plugins` array. For non-Vite bundlers, refer to the [TanStack Router CLI documentation](https://tanstack.com/router/latest/docs/framework/react/routing/installation-with-router-cli).

## Create Route Files

For file-based routing, create the following files in the `src/routes` directory:

1. **`src/routes/__root.tsx`**  
   Defines the root route and layout, including navigation links and an outlet for child routes.

```tsx
import { createRootRoute, Link, Outlet } from "@tanstack/react-router";
import { TanStackRouterDevtools } from "@tanstack/react-router-devtools";

export const Route = createRootRoute({
  component: () => (
    <>
      <Link to="/">Home</Link>
      <Link to="/about">About</Link>
      <Outlet />
      <TanStackRouterDevtools />
    </>
  ),
});
```

2. **`src/routes/index.tsx`**  
   Defines the home route, rendered at `/`.

```tsx
import { createLazyFileRoute } from "@tanstack/react-router";

export const Route = createLazyFileRoute("/")({
  component: Index,
});

function Index() {
  return <div>Welcome Home!</div>;
}
```

3. **`src/routes/about.tsx`**  
   Defines the about route, rendered at `/about`.

```tsx
import { createLazyFileRoute } from "@tanstack/react-router";

export const Route = createLazyFileRoute("/about")({
  component: About,
});

function About() {
  return <div>Hello from About!</div>;
}
```

The `createLazyFileRoute` function enables lazy loading, improving performance by loading route components only when needed. The `Outlet` in `__root.tsx` renders child routes, supporting nested routing structures.

## Set Up Main Application

In `src/main.tsx`, initialize the router using the generated `routeTree` and provide it to the `RouterProvider`:

```tsx
import { StrictMode } from "react";
import ReactDOM from "react-dom/client";
import { RouterProvider, createRouter } from "@tanstack/react-router";
import { routeTree } from "./routeTree.gen";

const router = createRouter({ routeTree });

declare module "@tanstack/react-router" {
  interface Register {
    router: typeof router;
  }
}

const rootElement = document.getElementById("root")!;
if (!rootElement.innerHTML) {
  const root = ReactDOM.createRoot(rootElement);
  root.render(
    <StrictMode>
      <RouterProvider router={router} />
    </StrictMode>
  );
}
```

The `routeTree.gen.ts` file is automatically generated by the Vite plugin based on your route files. Ensure the root element ID (`root`) matches the one in your `index.html`.

## Navigation

Navigation in TanStack Router is handled using the `Link` component, which enables seamless transitions between routes without full page reloads. In the root component, navigation links are defined as:

```tsx
<Link to="/">Home</Link>
<Link to="/about">About</Link>
```

Clicking these links navigates to the respective routes, rendering the corresponding components in the `Outlet`.

## Dynamic Routes

While the quick start guide focuses on basic routes, TanStack Router supports dynamic routes for flexible URLs (e.g., `/user/:id`). You can define a route file like `src/routes/user.$id.tsx` for file-based routing or use `createRoute` with a dynamic path in code-based configuration. For example:

```tsx
const userRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: "/user/$id",
  component: () => {
    const { id } = Route.useParams();
    return <div>User ID: {id}</div>;
  },
});
```

Refer to the [official documentation](https://tanstack.com/router/latest/docs/framework/react/routing/dynamic-routes) for detailed examples.

## Nested Routes

The quick start demonstrates nested routing via the `Outlet` component in `__root.tsx`, which renders child routes like `/` and `/about`. For more complex nested routes (e.g., `/dashboard/settings`), create additional route files or define child routes in code-based configuration. For instance:

```tsx
const dashboardRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: "/dashboard",
  component: () => (
    <>
      <Outlet />
    </>
  ),
});
const settingsRoute = createRoute({
  getParentRoute: () => dashboardRoute,
  path: "settings",
  component: () => <div>Settings</div>,
});
```

See the [nested routing guide](https://tanstack.com/router/latest/docs/framework/react/routing/nested-routes) for advanced setups.

## Additional Features

- **Devtools**: The `TanStackRouterDevtools` component provides a UI for inspecting and debugging routes during development, included in the root route example.
- **Code-Based Configuration**: For projects where file-based routing is not preferred, define routes directly in code. Below is an example of a code-based setup:

```tsx
const rootRoute = createRootRoute({
  component: () => (
    <>
      <Link to="/">Home</Link>
      <Link to="/about">About</Link>
      <Outlet />
      <TanStackRouterDevtools />
    </>
  ),
});

const indexRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: "/",
  component: () => <div>Welcome Home!</div>,
});

const aboutRoute = createRoute({
  getParentRoute: () => rootRoute,
  path: "/about",
  component: () => <div>Hello from About!</div>,
});
```

```tsx
const routeTree = rootRoute.addChildren([indexRoute, aboutRoute]);

const router = createRouter({ routeTree });

declare module "@tanstack/react-router" {
  interface Register {
    router: typeof router;
  }
}

const rootElement = document.getElementById("app")!;
if (!rootElement.innerHTML) {
  const root = ReactDOM.createRoot(rootElement);
  root.render(
    <StrictMode>
      <RouterProvider router={router} />
    </StrictMode>
  );
}
```

For larger applications, split route definitions into separate files to maintain organization.
